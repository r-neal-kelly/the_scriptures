import*as Utils from"../../utils.js";import*as Font from"../font.js";import*as Fonts from"../fonts.js";import{Script_Position}from"../script_position.js";export class Instance{constructor({font_name:t,short_font_name:s,fallback_font_names:i,font_size_multiplier:e,line_height_multiplier:n,styles:l,treater:o=Instance.DEFAULT_TREATER}){0,0,0,0,0;const r=Fonts.Singleton();this.font=r.Font(t),this.short_font_name=s,this.fallback_fonts=i.map((t=>r.Font(t))),this.font_size_multiplier=e,this.line_height_multiplier=n,this.styles=Object.assign(Object.create(null),l),this.treater=o;const _=this.fallback_fonts.map((t=>`"${t.Family()}"`)).join(", ");this.styles["font-family"]=""!==_?`"${this.font.Family()}", ${_}, sans-serif`:`"${this.font.Family()}", sans-serif`,null==this.styles["vertical-align"]&&(this.styles["vertical-align"]="baseline"),null==this.styles["letter-spacing"]&&(this.styles["letter-spacing"]="normal"),null==this.styles["word-spacing"]&&(this.styles["word-spacing"]="normal"),Object.freeze(this.fallback_fonts),Object.freeze(this.styles)}Font(){return this.font}Short_Font_Name(){return this.short_font_name}Fallback_Fonts(){return Array.from(this.fallback_fonts)}Font_Size_Multiplier(){return this.font_size_multiplier}Line_Height_Multiplier(){return this.line_height_multiplier}Styles({underlying_font_size_px:t,underlying_font_size_multiplier:s,script_position:i}){const e=Object.assign(Object.create(null),this.styles),n=t*s*this.font_size_multiplier,l=n*this.line_height_multiplier;return i===Script_Position.SUPER?(e["font-size"]=n*Font.Consts.SUPERSCRIPT_FONT_SIZE_MULTIPLIER+"px",e["line-height"]=l*Font.Consts.SUPERSCRIPT_LINE_HEIGHT_MULTIPLIER+"px",e["vertical-align"]="super"):i===Script_Position.SUB?(e["font-size"]=n*Font.Consts.SUBSCRIPT_FONT_SIZE_MULTIPLIER+"px",e["line-height"]=l*Font.Consts.SUBSCRIPT_LINE_HEIGHT_MULTIPLIER+"px",e["vertical-align"]="sub"):(e["font-size"]=`${n}px`,e["line-height"]=`${l}px`),e}Treat_Text(t){return this.treater(t)}}Instance.DEFAULT_TREATER=function(t){return t};