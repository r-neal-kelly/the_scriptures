var __awaiter=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(s,r){function o(t){try{d(i.next(t))}catch(t){r(t)}}function a(t){try{d(i.throw(t))}catch(t){r(t)}}function d(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}d((i=i.apply(t,e||[])).next())}))};import*as Utils from"../utils.js";export class Instance{constructor(){this.divs_to_hooks=new Map}Has_Div(t){return this.divs_to_hooks.has(t)}Add_Div(t,e){0,0,t.addEventListener("keydown",this.On_Keydown.bind(this)),t.addEventListener("keyup",this.On_Keyup.bind(this)),t.addEventListener("beforeinput",this.Before_Input.bind(this)),this.divs_to_hooks.set(t,e)}Remove_Div(t){0,t.removeEventListener("keydown",this.On_Keydown.bind(this)),t.removeEventListener("keyup",this.On_Keyup.bind(this)),t.removeEventListener("beforeinput",this.Before_Input.bind(this)),this.divs_to_hooks.delete(t)}On_Keydown(t){return __awaiter(this,void 0,void 0,(function*(){}))}On_Keyup(t){return __awaiter(this,void 0,void 0,(function*(){}))}Before_Input(t){return __awaiter(this,void 0,void 0,(function*(){const e=t.target,n=this.divs_to_hooks.get(e);if(0,0,0,"insertText"===t.inputType){t.data;const i=t.getTargetRanges();0,t.preventDefault(),yield n.On_Insert({div:e,data:t.data||"",target_range:i[0]}),yield n.After_Insert_Or_Paste_Or_Delete(t)}else"insertFromPaste"===t.inputType?(yield n.On_Paste(t),yield n.After_Insert_Or_Paste_Or_Delete(t)):"deleteContentBackward"===t.inputType&&(yield n.On_Delete(t),yield n.After_Insert_Or_Paste_Or_Delete(t))}))}}let singleton=null;export function Singleton(){return null==singleton&&(singleton=new Instance),singleton}