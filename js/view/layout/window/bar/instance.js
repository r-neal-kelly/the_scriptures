var __awaiter=this&&this.__awaiter||function(n,e,t,i){return new(t||(t=Promise))((function(s,r){function o(n){try{d(i.next(n))}catch(n){r(n)}}function a(n){try{d(i.throw(n))}catch(n){r(n)}}function d(n){var e;n.done?s(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(o,a)}d((i=i.apply(n,e||[])).next())}))};import*as Utils from"../../../../utils.js";import*as Event from"../../../../event.js";import*as Events from"../../../events.js";import*as Entity from"../../../entity.js";import*as Title from"./title.js";import*as Commands from"./commands.js";export class Instance extends Entity.Instance{constructor({model:n,window:e}){super({element:"div",parent:e,event_grid:e.Event_Grid()}),this.model=n,this.Live()}On_Life(){return this.Add_This_CSS("\n                .Bar {\n                    display: grid;\n                    grid-template-rows: auto;\n                    grid-template-columns: 1fr auto;\n\n                    width: 100%;\n                    height: 100%;\n\n                    overflow-x: hidden;\n                    overflow-y: hidden;\n\n                    border-color: white;\n                    border-style: solid;\n                    border-width: 0 0 1px 0;\n                }\n\n                .Active_Bar {\n                    color: black;\n                    background-color: white;\n                    border-color: black;\n                }\n            "),this.Add_Children_CSS("\n                .Title {\n                    padding: 4px;\n\n                    font-size: .8em;\n\n                    cursor: default;\n                    -webkit-user-select: none;\n                    -moz-user-select: none;\n                    -ms-user-select: none;\n                    user-select: none;\n                }\n\n                .Commands {\n                    display: grid;\n                    grid-template-rows: auto;\n                    grid-template-columns: 1fr 1fr 1fr;\n                    justify-items: center;\n                    justify-content: center;\n                    align-items: center;\n                    align-content: center;\n\n                    width: 100%;\n                    height: 100%;\n\n                    overflow-x: hidden;\n                    overflow-y: hidden;\n                }\n\n                .Button {\n                    margin: 4px;\n\n                    border-color: white;\n                    border-style: solid;\n                    border-width: 0;\n\n                    cursor: pointer;\n                    -webkit-user-select: none;\n                    -moz-user-select: none;\n                    -ms-user-select: none;\n                    user-select: none;\n                }\n            "),[new Event.Listener_Info({event_name:new Event.Name(Event.Prefix.ON,Events.WINDOW_ACTIVATE,this.Window().Wall().ID()),event_handler:this.On_Window_Activate,event_priority:0})]}On_Refresh(){this.Has_Title()&&this.Has_Commands()||(this.Abort_All_Children(),new Title.Instance({model:()=>this.Model().Title(),bar:this}),new Commands.Instance({model:()=>this.Model().Commands(),bar:this}))}On_Reclass(){const n=this.Model(),e=[];return e.push("Bar"),n.Window().Is_Active()&&e.push("Active_Bar"),e}On_Window_Activate(){return __awaiter(this,void 0,void 0,(function*(){this.Refresh()}))}Model(){return this.model()}Window(){return this.Parent()}Has_Title(){return this.Has_Child(0)&&this.Child(0)instanceof Title.Instance}Title(){return 0,this.Child(0)}Has_Commands(){return this.Has_Child(1)&&this.Child(1)instanceof Commands.Instance}Commands(){return 0,this.Child(1)}}