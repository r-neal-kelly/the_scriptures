var __awaiter=this&&this.__awaiter||function(t,n,e,i){return new(e||(e=Promise))((function(r,s){function o(t){try{l(i.next(t))}catch(t){s(t)}}function a(t){try{l(i.throw(t))}catch(t){s(t)}}function l(t){var n;t.done?r(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(o,a)}l((i=i.apply(t,n||[])).next())}))};import*as Utils from"../../utils.js";import*as Event from"../../event.js";import*as Events from"../events.js";import*as Entity from"../entity.js";import*as Wall from"./wall.js";import*as Bar from"./bar.js";export class Instance extends Entity.Instance{constructor({model:t,root:n}){super({element:"div",parent:n,event_grid:n.Event_Grid()}),this.model=t,this.Live()}On_Life(){return this.Add_This_CSS("\n                .Layout {\n                    display: grid;\n                    grid-template-rows: 1fr auto;\n                    grid-template-columns: auto;\n\n                    width: 100%;\n                    height: 100%;\n\n                    overflow-x: hidden;\n                    overflow-y: hidden;\n\n                    color: white;\n                }\n            "),this.Add_Children_CSS("\n                .Wall {\n                    display: grid;\n                    grid-row-gap: 2px;\n                    grid-column-gap: 2px;\n\n                    width: 100%;\n                    height: 100%;\n                    padding: 0 2px;\n\n                    overflow-x: hidden;\n                    overflow-y: hidden;\n                }\n\n                .Window {\n                    display: grid;\n                    grid-template-rows: auto 1fr;\n                    grid-template-columns: auto;\n\n                    width: 100%;\n                    height: 100%;\n\n                    overflow-x: auto;\n                    overflow-y: auto;\n\n                    border-color: white;\n                    border-style: solid;\n                    border-width: 1px;\n                }\n            "),[new Event.Listener_Info({event_name:new Event.Name(Event.Prefix.AFTER,Events.WINDOW_CLOSE,this.ID()),event_handler:this.After_Window_Close,event_priority:0})]}On_Refresh(){this.Has_Wall()&&this.Has_Bar()||(this.Abort_All_Children(),new Wall.Instance({model:()=>this.Model().Wall(),layout:this}),new Bar.Instance({model:()=>this.Model().Bar(),layout:this}))}On_Reclass(){return["Layout"]}After_Window_Close(){return __awaiter(this,void 0,void 0,(function*(){this.Refresh()}))}Model(){return this.model()}Root(){return this.Parent()}Has_Wall(){return this.Has_Child(0)&&this.Child(0)instanceof Wall.Instance}Wall(){return  this.Child(0)}Has_Bar(){return this.Has_Child(1)&&this.Child(1)instanceof Bar.Instance}Bar(){return  this.Child(1)}}