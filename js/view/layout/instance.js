var __awaiter=this&&this.__awaiter||function(t,e,s,n){return new(s||(s=Promise))((function(i,a){function o(t){try{h(n.next(t))}catch(t){a(t)}}function r(t){try{h(n.throw(t))}catch(t){a(t)}}function h(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(o,r)}h((n=n.apply(t,e||[])).next())}))};import*as Utils from"../../utils.js";import*as Event from"../../event.js";import*as Events from"../events.js";import*as Entity from"../entity.js";import*as Desktop from"./desktop.js";import*as Taskbar from"./taskbar.js";export class Instance extends Entity.Instance{constructor({model:t,root:e}){super({element:"div",parent:e,event_grid:e.Event_Grid()}),this.model=t,this.Live()}On_Life(){return this.Element().addEventListener("click",this.On_Click.bind(this)),this.Add_This_CSS("\n                .Layout {\n                    display: grid;\n                    grid-template-rows: 1fr auto;\n                    grid-template-columns: auto;\n\n                    width: 100%;\n                    height: 100%;\n\n                    overflow-x: hidden;\n                    overflow-y: hidden;\n\n                    color: white;\n                }\n            "),[]}On_Refresh(){this.Has_Desktop()&&this.Has_Taskbar()||(this.Abort_All_Children(),new Desktop.Instance({model:()=>this.Model().Desktop(),layout:this}),new Taskbar.Instance({model:()=>this.Model().Taskbar(),layout:this}))}On_Reclass(){return["Layout"]}On_Click(t){return __awaiter(this,void 0,void 0,(function*(){this.Model().Desktop().Menu().Is_Open()&&(yield this.Send(new Event.Info({affix:Events.MENU_CLOSE,suffixes:[this.ID()],type:Event.Type.EXCLUSIVE,data:{}})))}))}Model(){return this.model()}Root(){return this.Parent()}Has_Desktop(){return this.Has_Child(0)&&this.Child(0)instanceof Desktop.Instance}Desktop(){return 0,this.Child(0)}Has_Taskbar(){return this.Has_Child(1)&&this.Child(1)instanceof Taskbar.Instance}Taskbar(){return 0,this.Child(1)}}