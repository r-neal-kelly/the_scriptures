var __awaiter=this&&this.__awaiter||function(t,e,s,i){return new(s||(s=Promise))((function(n,r){function o(t){try{h(i.next(t))}catch(t){r(t)}}function _(t){try{h(i.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(o,_)}h((i=i.apply(t,e||[])).next())}))};import*as Utils from"../../utils.js";import*as Event from"../../event.js";import*as Events from"../events.js";import*as Entity from"../entity.js";import*as CSS from"./css.js";import*as Settings from"./settings.js";import*as Slots from"./slots.js";export class Instance extends Entity.Instance{constructor({parent:t,model:e,event_grid_hook:s,is_visible:i}){super({element:"div",parent:t,event_grid:t.Event_Grid()}),this.model=e,this.event_grid_hook=s,this.is_visible=i,this.Live()}On_Life(){return this.Add_This_CSS(CSS.This_CSS()),this.Add_Children_CSS(CSS.Children_CSS()),this.Add_CSS(CSS.CSS()),[new Event.Listener_Info({event_name:new Event.Name(Event.Prefix.AFTER,Events.SELECTOR_SLOT_ORDER_SELECT,this.ID()),event_handler:this.After_Selector_Slot_Order_Select,event_priority:0}),new Event.Listener_Info({event_name:new Event.Name(Event.Prefix.AFTER,Events.SELECTOR_SLOT_ITEM_SELECT,this.ID()),event_handler:this.After_Selector_Slot_Item_Select,event_priority:0})]}On_Refresh(){this.Has_Slots()&&this.Has_Settings()||(this.Abort_All_Children(),new Settings.Instance({selector:this,model:()=>this.Model().Settings()}),new Slots.Instance({selector:this,model:()=>this.Model()}))}On_Reclass(){const t=[];return t.push("Selector"),this.Is_Visible()||t.push("Invisible"),t}After_Selector_Slot_Order_Select(){return __awaiter(this,void 0,void 0,(function*(){this.Refresh()}))}After_Selector_Slot_Item_Select(){return __awaiter(this,void 0,void 0,(function*(){this.Refresh()}))}Model(){return this.model()}Event_Grid_Hook(){return this.event_grid_hook()}Is_Visible(){return this.is_visible()}Has_Settings(){return this.Has_Child(0)&&this.Child(0)instanceof Settings.Instance}Settings(){return 0,this.Child(0)}Has_Slots(){return this.Has_Child(1)&&this.Child(1)instanceof Slots.Instance}Slots(){return 0,this.Child(1)}}