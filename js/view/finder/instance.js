var __awaiter=this&&this.__awaiter||function(n,e,t,i){return new(t||(t=Promise))((function(s,r){function o(n){try{a(i.next(n))}catch(n){r(n)}}function d(n){try{a(i.throw(n))}catch(n){r(n)}}function a(n){var e;n.done?s(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(o,d)}a((i=i.apply(n,e||[])).next())}))};import*as Utils from"../../utils.js";import*as Event from"../../event.js";import*as Events from"../events.js";import*as Entity from"../entity.js";import*as Commander from"./commander.js";import*as Body from"./body.js";export class Instance extends Entity.Instance{constructor({parent:n,model:e,event_grid_hook:t}){super({element:"div",parent:n,event_grid:n.Event_Grid()}),this.model=e,this.event_grid_hook=t,this.Live()}On_Life(){return this.Add_This_CSS("\n                .Finder {\n                    display: grid;\n                    grid-template-rows: auto 1fr;\n                    grid-template-columns: 1fr;\n                    justify-content: start;\n\n                    width: 100%;\n                    height: 100%;\n\n                    overflow-x: hidden;\n                    overflow-y: hidden;\n\n                    color: white;\n                }\n            "),this.Add_Children_CSS("\n                .Invisible {\n                    display: none;\n                }\n            "),[new Event.Listener_Info({event_name:new Event.Name(Event.Prefix.ON,Events.FINDER_BODY_EXPRESSION_ENTER,this.ID()),event_handler:this.On_Finder_Body_Expression_Enter,event_priority:10})]}On_Refresh(){this.Has_Commander()&&this.Has_Body()||(this.Abort_All_Children(),new Commander.Instance({finder:this,model:()=>this.Model().Commander()}),new Body.Instance({finder:this,model:()=>this.Model().Body()}))}On_Reclass(){return["Finder"]}On_Restyle(){return`\n            font-size: ${this.Model().Body().Options().Underlying_Font_Size_PX()}px;\n        `}On_Finder_Body_Expression_Enter(){return __awaiter(this,void 0,void 0,(function*(){yield this.Send(new Event.Info({affix:Events.WINDOW_REFRESH_TITLE,suffixes:[this.Event_Grid_Hook()],type:Event.Type.EXCLUSIVE,data:{}}))}))}Model(){return this.model()}Event_Grid_Hook(){return this.event_grid_hook()}Has_Commander(){return this.Has_Child(0)&&this.Child(0)instanceof Commander.Instance}Commander(){return 0,this.Child(0)}Has_Body(){return this.Has_Child(1)&&this.Child(1)instanceof Body.Instance}Body(){return 0,this.Child(1)}}